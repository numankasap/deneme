# Geometry Visual Bot v2.0 - GitHub Actions Workflow
# ===================================================
# Curriculum tablosundaki geometri kazanÄ±mlarÄ±na gÃ¶re
# gÃ¶rselsiz sorulara geometrik gÃ¶rsel Ã¼retir.

name: Geometry Visual Bot

on:
  # Manuel tetikleme
  workflow_dispatch:
    inputs:
      batch_size:
        description: 'Ä°ÅŸlenecek soru sayÄ±sÄ±'
        required: false
        default: '10'
        type: string
      quality_threshold:
        description: 'Kalite eÅŸiÄŸi (1-10)'
        required: false
        default: '7'
        type: string

  # ZamanlanmÄ±ÅŸ Ã§alÄ±ÅŸma (her gÃ¼n saat 03:00 UTC)
  schedule:
    - cron: '0 3 * * *'

jobs:
  generate-geometry-visuals:
    runs-on: ubuntu-latest
    timeout-minutes: 60

    steps:
      - name: ðŸ“¥ Checkout repository
        uses: actions/checkout@v4

      - name: ðŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'

      - name: ðŸ“¦ Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install supabase google-genai

      - name: ðŸŽ¨ Run Geometry Visual Bot
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_SERVICE_KEY: ${{ secrets.SUPABASE_KEY }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          BATCH_SIZE: ${{ github.event.inputs.batch_size || '10' }}
          QUALITY_THRESHOLD: ${{ github.event.inputs.quality_threshold || '7' }}
        run: |
          echo "ðŸŽ¨ Geometry Visual Bot BaÅŸlatÄ±lÄ±yor..."
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸ“… Tarih: $(date)"
          echo "ðŸ“Š Batch Size: $BATCH_SIZE soru"
          echo "ðŸ” Kalite EÅŸiÄŸi: $QUALITY_THRESHOLD/10"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          python geometry_visual_bot.py

      - name: ðŸ“Š Job Summary
        if: always()
        run: |
          echo "## ðŸŽ¨ Geometry Visual Bot SonuÃ§larÄ±" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- **Tarih:** $(date)" >> $GITHUB_STEP_SUMMARY
          echo "- **Batch Size:** ${{ github.event.inputs.batch_size || '10' }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Kalite EÅŸiÄŸi:** ${{ github.event.inputs.quality_threshold || '7' }}/10" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… Ä°ÅŸ tamamlandÄ±!" >> $GITHUB_STEP_SUMMARY
