# Scenario Bot v3.0 Workflow
# ESNEK VE ZENGÄ°N GÃ–RSEL DESTEÄžÄ°:
# - Geometrik ÅŸekiller (silindir, kÃ¼p, prizma, koni, kÃ¼re)
# - Grafikler (Ã§ubuk, Ã§izgi, pasta)
# - Dinamik tablolar
# - KarÅŸÄ±laÅŸtÄ±rma kartlarÄ±
# - Ä°nfografikler
#
# Dinamik soru metni - statik deÄŸil gerÃ§ek soru!

name: Scenario Bot v3

on:
  workflow_dispatch:
    inputs:
      test_mode:
        description: 'Test modu (10 soru)'
        required: false
        default: 'false'
        type: choice
        options:
          - 'true'
          - 'false'
      batch_size:
        description: 'Ä°ÅŸlenecek soru sayÄ±sÄ± (1-100)'
        required: false
        default: '30'
        type: string
  
  schedule:
    - cron: '0 6 * * *'   # 09:00 TR
    - cron: '0 12 * * *'  # 15:00 TR
    - cron: '0 18 * * *'  # 21:00 TR

jobs:
  generate-visuals:
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v4
      
      - name: ðŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'
      
      - name: ðŸ“¦ Install dependencies
        run: |
          pip install --upgrade pip
          pip install -r scenario_requirements.txt
      
      - name: ðŸŽ­ Install Playwright
        run: |
          playwright install chromium
          playwright install-deps chromium
      
      - name: ðŸ–¼ï¸ Run Scenario Bot v3
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          TEST_MODE: ${{ github.event.inputs.test_mode || 'false' }}
          BATCH_SIZE: ${{ github.event.inputs.batch_size || '30' }}
        run: |
          echo "ðŸš€ Senaryo GÃ¶rsel Botu v3.0"
          echo "ðŸ“… $(date)"
          echo ""
          echo "ðŸ†• v3.0 Ã–zellikleri:"
          echo "   ðŸ“ Geometrik ÅŸekiller (silindir, kÃ¼p, koni, kÃ¼re)"
          echo "   ðŸ“Š Grafikler (Ã§ubuk, Ã§izgi, pasta)"
          echo "   ðŸ“‹ Dinamik tablolar"
          echo "   âš–ï¸ KarÅŸÄ±laÅŸtÄ±rma kartlarÄ±"
          echo "   â“ Dinamik soru metni"
          echo ""
          python scenario_bot.py
      
      - name: ðŸ“Š Summary
        if: always()
        run: |
          echo "## ðŸ–¼ï¸ Senaryo Bot v3.0 TamamlandÄ±" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ†• Desteklenen GÃ¶rsel Tipleri" >> $GITHUB_STEP_SUMMARY
          echo "| Tip | AÃ§Ä±klama |" >> $GITHUB_STEP_SUMMARY
          echo "|-----|----------|" >> $GITHUB_STEP_SUMMARY
          echo "| comparison_geometry | Geometrik ÅŸekillerle karÅŸÄ±laÅŸtÄ±rma |" >> $GITHUB_STEP_SUMMARY
          echo "| comparison | Basit karÅŸÄ±laÅŸtÄ±rma kartlarÄ± |" >> $GITHUB_STEP_SUMMARY
          echo "| table | Veri tablosu |" >> $GITHUB_STEP_SUMMARY
          echo "| bar_chart | Ã‡ubuk grafik |" >> $GITHUB_STEP_SUMMARY
          echo "| line_chart | Ã‡izgi grafik |" >> $GITHUB_STEP_SUMMARY
          echo "| pie_chart | Pasta grafik |" >> $GITHUB_STEP_SUMMARY
          echo "| geometry | Sadece geometrik ÅŸekiller |" >> $GITHUB_STEP_SUMMARY
          echo "| infographic | Bilgi kartlarÄ± |" >> $GITHUB_STEP_SUMMARY
